version: 2
models:
  - name: movie_success
    description: |
      Final model for calculating combined success movie success.

    columns:
      - name: imdb_id
        description: |
          {{ doc("stg_tmdb_movies__imdb_id") }}
        tests:
          - unique
          - not_null
        meta:
          dimension:
            type: string
          metrics:
            movie_count:
              type: count_distinct
              label: "Number of distinct movies"

      - name: title
        description: |
          {{ doc("int_movies_mapping__title") }}
        meta:
          dimension:
            type: string

      - name: original_title
        description: |
          {{ doc("stg_tmdb_movies__original_title") }}
        meta:
          dimension:
            type: string

      - name: director
        description: |
          {{ doc("stg_omdb_movies__director") }}
        meta:
          dimension:
            type: string

      - name: actors
        description: |
          {{ doc("stg_omdb_movies__actors") }}
        meta:
          dimension:
            type: string

      - name: genre
        description: |
          {{ doc("int_movies_mapping__genre") }}
        meta:
          dimension:
            type: string

      - name: language
        description: |
          {{ doc("int_movies_mapping__language") }}
        meta:
          dimension:
            type: string

      - name: runtime
        description: |
          {{ doc("int_movies_mapping__runtime") }}
        meta:
          dimension:
            type: number

      - name: imdb_rating
        description: |
          {{ doc("int_movies_mapping__imdb_rating") }}
        meta:
          dimension:
            type: number
          metrics:
            total_imdb_rating:
              type: sum
              label: "Total IMDB rating"
              round: 1
            avg_imdb_rating:
              type: average
              label: "Avg IMDB rating"
              round: 1

      - name: imdb_votes
        description: |
          {{ doc("int_movies_mapping__imdb_votes") }}
        meta:
          dimension:
            type: number
          metrics:
            total_imdb_votes:
              type: sum
              label: "Total IMDB votes"
              round: 1
            avg_imdb_votes:
              type: average
              label: "Avg IMDB votes"
              round: 1

      - name: omdb_rt_rating
        description: |
          {{ doc("stg_omdb_movies__omdb_rt_rating") }}
        meta:
          dimension:
            type: number

      - name: number_of_awards_won
        description: |
          {{ doc("stg_omdb_movies__number_of_awards_won") }}
        meta:
          dimension:
            type: number
          metrics:
            total_number_of_awards_won:
              type: sum
              label: "Total number of awards won"
              round: 1
            avg_number_of_awards_won:
              type: average
              label: "Avg number of awards won"
              round: 1

      - name: combined_rotten_tomato_rating
        description: |
          {{ doc("int_combined_movie_success__combined_rotten_tomato_rating") }}
        meta:
          dimension:
            type: number
          metrics:
            total_combined_rotten_tomato_rating:
              type: sum
              label: "Total combined rotten tomato rating"
              round: 1
            avg_combined_rotten_tomato_rating:
              type: average
              label: "Avg combined rotten tomato rating"
              round: 1

      - name: viewer_vote_average
        description: |
          {{ doc("stg_tmdb_movies__vote_average") }}
        meta:
          dimension:
            type: number
          metrics:
            total_viewer_vote:
              type: sum
              label: "Total viewer votes"
              round: 1
            avg_viewer_votee:
              type: average
              label: "Avg viewer votes"
              round: 1
             
      - name: viewer_vote_count
        description: |
          {{ doc("stg_tmdb_movies__vote_count") }}
        meta:
          dimension:
            type: number
          metrics:
            total_viewer_vote_count:
              type: sum
              label: "Total viewer vote count"
              round: 1
            avg_viewer_vote_count:
              type: average
              label: "Avg viewer vote count"
              round: 1

      - name: revenue
        description: |
          {{ doc("stg_tmdb_movies__revenue") }}
        meta:
          dimension:
            type: number
          metrics:
            total_revenue:
              type: sum
              label: "Total revenue"
              round: 1
            avg_revenue:
              type: average
              label: "Avg revenue"
              round: 1

      - name: inflation_corrected_revenue
        description: |
          {{ doc("int_movies_mapping__inflation_corrected_revenue") }}
        meta:
          dimension:
            type: number
        metrics:
            total_inflation_corrected_revenue:
              type: sum
              label: "Total inflation corrected revenue"
              round: 1
            avg_inflation_corrected_revenue:
              type: average
              label: "Avg inflation corrected revenue"
              round: 1

      - name: release_date
        description: |
          {{ doc("int_movies_mapping__release_date") }}
        meta:
          dimension:
            type: date

      - name: combined_success_rating
        description: |
          {{ doc("int_combined_movie_success__combined_success_rating") }}
        meta:
          dimension:
            type: number
          metrics:
            total_combined_success_rating:
              type: sum
              label: "Total combined success rating"
              round: 1
            avg_combined_success_rating:
              type: average
              label: "Avg combined success rating"
              round: 1

      - name: imdb_votes_normalized
        description: |
          {{ doc("int_combined_movie_success__imdb_votes_normalized") }}
        meta:
          dimension:
            type: number
          metrics:
            total_imdb_votes_normalized:
              type: sum
              label: "Total normalized imdb votes"
              round: 1
            avg_imdb_votes_normalized:
              type: average
              label: "Avg normalized imdb votes"
              round: 1

      - name: number_of_awards_won_normalized
        description: |
          {{ doc("int_combined_movie_success__number_of_awards_won_normalized") }}
        meta:
          dimension:
            type: number
          metrics:
            total_number_of_awards_won_normalized:
              type: sum
              label: "Total number of awards normalized"
              round: 1
            avg_number_of_awards_won_normalized:
              type: average
              label: "Avg number of awards normalized"
              round: 1

      - name: viewer_vote_count_normalized
        description: |
          {{ doc("int_combined_movie_success__viewer_vote_count_normalized") }}
        meta:
          dimension:
            type: number
          metrics:
            total_viewer_vote_count_normalized:
              type: sum
              label: "Total viewer vote count normalized"
              round: 1
            avg_viewer_vote_count_normalized:
              type: average
              label: "Avg  viewer vote count normalized"
              round: 1

      - name: revenue_normalized
        description: |
          {{ doc("int_combined_movie_success__revenue_normalized") }}
        meta:
          dimension:
            type: number
          metrics:
            total_revenue_normalized:
              type: sum
              label: "Total revenue normalized"
              round: 1
            avg_revenue_normalized:
              type: average
              label: "Avg revenue normalized"
              round: 1
      
      - name: inflation_corrected_revenue
        description: |
          {{ doc("int_combined_movie_success__inflation_corrected_revenue") }}
        meta:
          dimension:
            type: number
          metrics:
            total_inflation_corrected_revenue:
              type: sum
              label: "Total inflation correct revenue"
              round: 1
            avg_inflation_corrected_revenue:
              type: average
              label: "Avg inflation correct revenue"
              round: 1

  - name: actor_director_success
    description: |
      Final model showing success metrics for actor director pair.

    columns:
      - name: director_actor_key
        description: |
          {{ doc("actor_director_success__director_actor_key") }}
        tests:
          - not_null
        meta:
          dimension:
            type: string
      
      - name: imdb_id
        description: |
          {{ doc("stg_tmdb_movies__imdb_id") }}
        meta:
          dimension:
            type: string
          metrics:
            distinct_movie_occurences:
              type: count_distinct
              label: "Distinct number of movie occurences"

      - name: title
        description: |
          {{ doc("int_movies_mapping__title") }}
        meta:
          dimension:
            type: string

      - name: original_title
        description: |
          {{ doc("stg_tmdb_movies__original_title") }}
        meta:
          dimension:
            type: string
      
      - name: best_movie_of_director_actor
        description: |
          {{ doc("actor_director_success__best_movie_of_director_actor") }}
        meta:
          dimension:
            type: string

      - name: director
        description: |
          {{ doc("actor_director_success__director") }}
        meta:
          dimension:
            type: string

      - name: actor
        description: |
          {{ doc("actor_director_success__actor") }}
        meta:
          dimension:
            type: string

      - name: genre
        description: |
          {{ doc("int_movies_mapping__genre") }}
        meta:
          dimension:
            type: string

      - name: runtime
        description: |
          {{ doc("int_movies_mapping__runtime") }}
        meta:
          dimension:
            type: string

      - name: imdb_rating
        description: |
          {{ doc("int_movies_mapping__imdb_rating") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_imdb_rating:
              type: average
              label: "Avg IMDB rating"
              round: 1

      - name: imdb_votes
        description: |
          {{ doc("int_movies_mapping__imdb_votes") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_imdb_votes:
              type: average
              label: "Avg IMDB votes"
              round: 1

      - name: number_of_awards_won
        description: |
          {{ doc("stg_omdb_movies__number_of_awards_won") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_number_of_awards_won:
              type: average
              label: "Avg number of awards won"
              round: 1

      - name: combined_rotten_tomato_rating
        description: |
          {{ doc("int_combined_movie_success__combined_rotten_tomato_rating") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_combined_rotten_tomato_rating:
              type: average
              label: "Avg combined rotten tomato rating"
              round: 1

      - name: viewer_vote_average
        description: |
          {{ doc("stg_tmdb_movies__vote_average") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_viewer_votee:
              type: average
              label: "Avg viewer votes"
              round: 1
             
      - name: viewer_vote_count
        description: |
          {{ doc("stg_tmdb_movies__vote_count") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_viewer_vote_count:
              type: average
              label: "Avg viewer vote count"
              round: 1

      - name: revenue
        description: |
          {{ doc("stg_tmdb_movies__revenue") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_revenue:
              type: average
              label: "Avg revenue"
              round: 1

      - name: inflation_corrected_revenue
        description: |
          {{ doc("int_movies_mapping__inflation_corrected_revenue") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_inflation_corrected_revenue:
              type: average
              label: "Avg inflation corrected revenue"
              round: 1

      - name: combined_success_rating
        description: |
          {{ doc("int_combined_movie_success__combined_success_rating") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_combined_success_rating:
              type: average
              label: "Avg combined success rating"
              round: 1
      
      - name: imdb_votes_normalized
        description: |
          {{ doc("int_combined_movie_success__imdb_votes_normalized") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_imdb_votes_normalized:
              type: average
              label: "Avg normalized imdb votes normalized"
              round: 1

      - name: number_of_awards_won_normalized
        description: |
          {{ doc("int_combined_movie_success__number_of_awards_won_normalized") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_number_of_awards_won_normalized:
              type: average
              label: "Avg number of awards normalized"
              round: 1

      - name: viewer_vote_count_normalized
        description: |
          {{ doc("int_combined_movie_success__viewer_vote_count_normalized") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_viewer_vote_count_normalized:
              type: average
              label: "Avg  viewer vote count normalized"
              round: 1

      - name: revenue_normalized
        description: |
          {{ doc("int_combined_movie_success__revenue_normalized") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_revenue_normalized:
              type: average
              label: "Avg revenue normalized"
              round: 1

      - name: inflation_corrected_revenue
        description: |
          {{ doc("int_combined_movie_success__inflation_corrected_revenue") }}
        meta:
          dimension:
            type: number
          metrics:
            avg_inflation_corrected_revenue:
              type: average
              label: "Avg inflation correct revenue"
              round: 1